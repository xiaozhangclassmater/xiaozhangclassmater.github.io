<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ORMæ¡†æ¶ï¼ˆsqeuelizeï¼‰ğŸƒ</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.a90809c0.css" as="style"><link rel="preload" href="/assets/js/app.feb21b2a.js" as="script"><link rel="preload" href="/assets/js/2.75ba61f2.js" as="script"><link rel="preload" href="/assets/js/6.695dc6e3.js" as="script"><link rel="prefetch" href="/assets/js/10.be2d4676.js"><link rel="prefetch" href="/assets/js/11.a6cdee63.js"><link rel="prefetch" href="/assets/js/12.f66c58d3.js"><link rel="prefetch" href="/assets/js/13.f6a7ab74.js"><link rel="prefetch" href="/assets/js/14.f2495746.js"><link rel="prefetch" href="/assets/js/15.501e6ef6.js"><link rel="prefetch" href="/assets/js/16.f88cdb61.js"><link rel="prefetch" href="/assets/js/17.cee20973.js"><link rel="prefetch" href="/assets/js/18.45990e00.js"><link rel="prefetch" href="/assets/js/19.c5e4d633.js"><link rel="prefetch" href="/assets/js/20.72e018c7.js"><link rel="prefetch" href="/assets/js/21.bc6f4b58.js"><link rel="prefetch" href="/assets/js/22.233bac0d.js"><link rel="prefetch" href="/assets/js/3.ec1e420f.js"><link rel="prefetch" href="/assets/js/4.0a0d7342.js"><link rel="prefetch" href="/assets/js/5.fb1d9eba.js"><link rel="prefetch" href="/assets/js/7.f7cf561e.js"><link rel="prefetch" href="/assets/js/8.65918f4e.js"><link rel="prefetch" href="/assets/js/9.74b6acd4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a90809c0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://xiaozhangclassmater.github.io/minivueBarrage-docs-web/#/dashboard" target="_self" class="nav-link external">
  é¦–é¡µ
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webçŸ¥è¯†å¹¿åœº" class="dropdown-title"><span class="title">webçŸ¥è¯†å¹¿åœº</span> <span class="arrow down"></span></button> <button type="button" aria-label="webçŸ¥è¯†å¹¿åœº" class="mobile-dropdown-title"><span class="title">webçŸ¥è¯†å¹¿åœº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/javascript/javascript.html" class="nav-link">
  JavaScriptç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/vue/vue3.html" class="nav-link">
  vueç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/React/React.html" class="nav-link">
  reactç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/webpack/webpack.html" class="nav-link">
  webpackç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/Browser/Browser.html" class="nav-link">
  æµè§ˆå™¨ç¬”è®°
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NodeJsç³»åˆ—" class="dropdown-title"><span class="title">NodeJsç³»åˆ—</span> <span class="arrow down"></span></button> <button type="button" aria-label="NodeJsç³»åˆ—" class="mobile-dropdown-title"><span class="title">NodeJsç³»åˆ—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/node/Node.html" class="nav-link">
  NodeJSç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/ORM/ORM.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Node_ORMæ¡†æ¶ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/express/express.html" class="nav-link">
  expressç¬”è®°
</a></li></ul></div></div><div class="nav-item"><a href="/web/sql/mysql.html" class="nav-link">
  sqlç¬”è®°
</a></div><div class="nav-item"><a href="/web/netWork/netWork.html" class="nav-link">
  è®¡ç®—æœºç½‘ç»œç¬”è®°
</a></div><div class="nav-item"><a href="/web/InterviewQuestion/InterviewQuestion.html" class="nav-link">
  é¢è¯•é¢˜
</a></div><div class="nav-item"><a href="/web/studyNote/studyNote.html" class="nav-link">
  å·¥ä½œç¬”è®°
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://xiaozhangclassmater.github.io/minivueBarrage-docs-web/#/dashboard" target="_self" class="nav-link external">
  é¦–é¡µ
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="webçŸ¥è¯†å¹¿åœº" class="dropdown-title"><span class="title">webçŸ¥è¯†å¹¿åœº</span> <span class="arrow down"></span></button> <button type="button" aria-label="webçŸ¥è¯†å¹¿åœº" class="mobile-dropdown-title"><span class="title">webçŸ¥è¯†å¹¿åœº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/javascript/javascript.html" class="nav-link">
  JavaScriptç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/vue/vue3.html" class="nav-link">
  vueç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/React/React.html" class="nav-link">
  reactç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/webpack/webpack.html" class="nav-link">
  webpackç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/Browser/Browser.html" class="nav-link">
  æµè§ˆå™¨ç¬”è®°
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NodeJsç³»åˆ—" class="dropdown-title"><span class="title">NodeJsç³»åˆ—</span> <span class="arrow down"></span></button> <button type="button" aria-label="NodeJsç³»åˆ—" class="mobile-dropdown-title"><span class="title">NodeJsç³»åˆ—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web/node/Node.html" class="nav-link">
  NodeJSç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/ORM/ORM.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Node_ORMæ¡†æ¶ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/web/express/express.html" class="nav-link">
  expressç¬”è®°
</a></li></ul></div></div><div class="nav-item"><a href="/web/sql/mysql.html" class="nav-link">
  sqlç¬”è®°
</a></div><div class="nav-item"><a href="/web/netWork/netWork.html" class="nav-link">
  è®¡ç®—æœºç½‘ç»œç¬”è®°
</a></div><div class="nav-item"><a href="/web/InterviewQuestion/InterviewQuestion.html" class="nav-link">
  é¢è¯•é¢˜
</a></div><div class="nav-item"><a href="/web/studyNote/studyNote.html" class="nav-link">
  å·¥ä½œç¬”è®°
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/" class="sidebar-heading clickable router-link-active"><span>å¿«é€Ÿä¸Šæ‰‹</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ä¸ªäººç¬”è®°</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/javascript/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/web/webpack/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/web/vue/vue3.html" class="sidebar-link">vue3</a></li><li><a href="/web/React/React.html" class="sidebar-link">React</a></li><li><a href="/web/node/Node.html" class="sidebar-link">NodeJS</a></li><li><a href="/web/sql/mysql.html" class="sidebar-link">Mysql</a></li><li><a href="/web/ORM/ORM.html" aria-current="page" class="active sidebar-link">Node_ORM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/ORM/ORM.html#ormæ¡†æ¶-sqeuelize-ğŸƒ" class="sidebar-link">ORMæ¡†æ¶ï¼ˆsqeuelizeï¼‰ğŸƒ</a></li><li class="sidebar-sub-header"><a href="/web/ORM/ORM.html#å…¥é—¨ğŸ" class="sidebar-link">å…¥é—¨ğŸ</a></li><li class="sidebar-sub-header"><a href="/web/ORM/ORM.html#æœåŠ¡ç«¯åˆ†å±‚æ¶æ„ğŸ«" class="sidebar-link">æœåŠ¡ç«¯åˆ†å±‚æ¶æ„ğŸ«</a></li><li class="sidebar-sub-header"><a href="/web/ORM/ORM.html#æ¨¡å‹æŸ¥è¯¢æ•°æ®-model-query-ğŸ›’" class="sidebar-link">æ¨¡å‹æŸ¥è¯¢æ•°æ®ï¼ˆmodel queryï¼‰ğŸ›’</a></li><li class="sidebar-sub-header"><a href="/web/ORM/ORM.html#æ¨¡å‹åŸºç¡€ğŸ" class="sidebar-link">æ¨¡å‹åŸºç¡€ğŸ</a></li><li class="sidebar-sub-header"><a href="/web/ORM/ORM.html#nodejs-æ—¥å¿—è¾“å‡ºâœŒ" class="sidebar-link">nodejs-æ—¥å¿—è¾“å‡ºâœŒ</a></li><li class="sidebar-sub-header"><a href="/web/ORM/ORM.html#expressçš„åŸºæœ¬ä½¿ç”¨" class="sidebar-link">expressçš„åŸºæœ¬ä½¿ç”¨</a></li></ul></li><li><a href="/web/express/express.html" class="sidebar-link">express</a></li><li><a href="/web/Browser/Browser.html" class="sidebar-link">Browser</a></li><li><a href="/web/InterviewQuestion/InterviewQuestion.html" class="sidebar-link">é¢è¯•é¢˜</a></li><li><a href="/web/netWork/netWork.html" class="sidebar-link">è®¡ç®—æœºç½‘ç»œ</a></li><li><a href="/web/studyNote/studyNote.html" class="sidebar-link">å·¥ä½œç¬”è®°</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ormæ¡†æ¶-sqeuelize-ğŸƒ"><a href="#ormæ¡†æ¶-sqeuelize-ğŸƒ" class="header-anchor">#</a> ORMæ¡†æ¶ï¼ˆsqeuelizeï¼‰ğŸƒ</h2> <h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="header-anchor">#</a> ç®€ä»‹</h3> <p><img src="/assets/img/1693878830911.a374b06e.png" alt="1693878830911"></p> <p><a href="https://sequelize.org/docs/v6/core-concepts/model-basics/" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£SqeueLize<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>1 ï¼š Object Relational Mapping ï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰</strong></p> <p><strong>ä½œç”¨</strong></p> <ol><li>é€šè¿‡<code>ORM</code>æ¡†æ¶ï¼Œå¯ä»¥è‡ªåŠ¨çš„æŠŠç¨‹åºä¸­çš„å¯¹è±¡å’Œæ•°æ®åº“è¿›è¡Œå…³è”ï¼Œæ›´æ–¹ä¾¿ç®¡ç†</li> <li><code>ORM</code>æ¡†æ¶ä¼šéšè—å…·ä½“çš„æ•°æ®åº“åº•å±‚ç»†èŠ‚ï¼Œè®©å¼€å‘è€…ä½¿ç”¨åŒæ ·çš„æ•°æ®åº“æ“ä½œæ¥å£ï¼Œå®Œå…¨å¯¹ä¸åŒçš„æ•°æ®åº“æ“ä½œ</li></ol> <p><strong>ä¼˜åŠ¿</strong></p> <ol><li>å¼€å‘è€…ä¸éœ€è¦å…³å¿ƒæ•°æ®åº“ï¼Œåªéœ€è¦å…³å¿ƒè‡ªå·±å®šä¹‰çš„<code>model</code>å³å¯ç”Ÿæˆæ•°æ®åº“è¡¨å­—æ®µ</li> <li>å¯è½»æ˜“çš„å®Œæˆæ•°æ®åº“çš„ç§»æ¤</li> <li>æ— éœ€æ‹¼æ¥å¤æ‚çš„sqlè¯­å¥å³å¯å®Œæˆç²¾ç¡®æŸ¥è¯¢åŠŸèƒ½</li> <li>è¿æ¥å„ä¸ªæ•°æ®åº“ï¼Œç»Ÿä¸€å†…éƒ¨æ“ä½œæ•°æ®ï¼Œä¸éœ€è¦æ‰‹åŠ¨å†™sqlï¼Œç®€å•é«˜æ•ˆï¼Œå¯ç»´æŠ¤æ€§é«˜</li></ol> <p><img src="/assets/img/1693879182567.294367b3.png" alt="1693879182567"></p> <h2 id="å…¥é—¨ğŸ"><a href="#å…¥é—¨ğŸ" class="header-anchor">#</a> å…¥é—¨ğŸ</h2> <h3 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="header-anchor">#</a> åŸºæœ¬é…ç½®</h3> <p><strong>desc</strong> ï¼š è¿æ¥åˆ°æ•°æ®åº“</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> Sequelize <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'sequelize'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> authInfoGroup <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../constant/index'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">ACCOUNT</span><span class="token punctuation">,</span> <span class="token constant">PASSWORD</span> <span class="token punctuation">}</span> <span class="token operator">=</span> authInfoGroup
<span class="token keyword">const</span> sequelize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sequelize</span><span class="token punctuation">(</span><span class="token string">'ormdb'</span><span class="token punctuation">,</span> <span class="token constant">ACCOUNT</span><span class="token punctuation">,</span> <span class="token constant">PASSWORD</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dialect</span><span class="token operator">:</span> <span class="token string">'mysql'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">logging</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token comment">// æ˜¯å¦éœ€è¦è¯¦ç»†çš„æ‰“å°æ—¥å¿—</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// try {</span>
  <span class="token comment">//   await sequelize.authenticate();</span>
  <span class="token comment">//   console.log('Connection has been established successfully.');</span>
  <span class="token comment">// } catch (error) {</span>
  <span class="token comment">//   console.error('Unable to connect to the database:', error);</span>
  <span class="token comment">// }</span>
  <span class="token comment">// console.log('è¿æ¥æˆåŠŸ');</span>
  <span class="token comment">// sequelize.close()</span>
<span class="token punctuation">}</span>
<span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> sequelize
</code></pre></div><h3 id="model-å±‚"><a href="#model-å±‚" class="header-anchor">#</a> model å±‚</h3> <p><code>model</code>  æ¨¡å‹å®ä¾‹æ˜¯ORMæ¡†æ¶çš„ä¸€ä¸ªæ ¸å¿ƒè¦ç‚¹ï¼Œå®ƒå¯ä»¥æ ¹æ®ä¼ å…¥çš„ <code>JavaScript</code>å¯¹è±¡ å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆæ•°æ®åº“å­—æ®µï¼Œä»è€Œä¸æ•°æ®è¿›è¡Œç»Ÿä¸€ã€‚</p> <h4 id="åˆ›å»ºä¸€ä¸ªæ¨¡å‹"><a href="#åˆ›å»ºä¸€ä¸ªæ¨¡å‹" class="header-anchor">#</a> åˆ›å»ºä¸€ä¸ªæ¨¡å‹</h4> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>sequelize<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'æ¨¡å‹åç§°'</span> <span class="token punctuation">,</span> æ¨¡å‹å¯¹è±¡<span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DataTypes <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'sequelize'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> sequelize <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./db'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> modeNameGroup <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../constant'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> Admin <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>modeNameGroup<span class="token punctuation">.</span>Admin<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">loginId</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// ç±»å‹</span>
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦å…è®¸ä¸ºç©º</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">loginPwd</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// ç±»å‹</span>
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦å…è®¸ä¸ºç©º</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">updatedAt</span><span class="token operator">:</span> <span class="token string">'updateTime'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deletedAt</span><span class="token operator">:</span> <span class="token string">&quot;deleteTime&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token string">&quot;createTime&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Admin
</code></pre></div><h3 id="serviceå±‚"><a href="#serviceå±‚" class="header-anchor">#</a> serviceå±‚</h3> <p>ç”¨äºå¤„ç†æ•°æ®æ“ä½œæ•°æ®åº“å¹¶ä¸”è¿”å›ä¸€äº›æŒ‡å®šçš„æ•°æ®ç­‰ï¼Œè¯¥å±‚ä¼šå‚ä¸æœåŠ¡ç«¯é€»è¾‘éªŒè¯ï¼Œé€šè¿‡åå“åº”å¯¹åº”çš„æ•°æ®</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> Admin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models'</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">addAdmin</span><span class="token punctuation">(</span><span class="token parameter">adminObj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>adminObj<span class="token punctuation">)</span> <span class="token keyword">return</span>
  <span class="token keyword">const</span> modelInstance <span class="token operator">=</span> <span class="token keyword">await</span> Admin<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>adminObj<span class="token punctuation">)</span> <span class="token comment">// æ•°æ®å¤„ç†</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>modelInstance<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token comment">// å¦‚æœæ²¡æœ‰å®ä¾‹åˆ™ ç»“æŸæ“ä½œ</span>
  <span class="token keyword">return</span> modelInstance<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// è¿”å›æ•°æ®å¤„ç†åçš„å¯¹è±¡</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">deleteAdmin</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>id<span class="token punctuation">)</span> <span class="token keyword">return</span>
  <span class="token comment">//  æ–¹æ³•1 æŸ¥è¯¢å®ä¾‹æ˜¯å¦å­˜åœ¨ å­˜åœ¨ åˆ™é”€æ¯ ä¸å­˜åœ¨ ç»“æŸ</span>
  <span class="token comment">// const modelInstance = await Admin.findByPk(id) // æŸ¥è¯¢æ˜¯å¦æœ‰æ”¹æ¡è®°å½•</span>
  <span class="token comment">// modelInstance &amp;&amp; modelInstance.destroy()// é”€æ¯å®ä¾‹</span>

  <span class="token comment">// æ–¹æ³•äºŒ é€šè¿‡ æœ¬èº«è¿›è¡Œé”€æ¯</span>
  Admin<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateAdmin</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> adminObj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * æ–¹å¼1
   */</span>
  <span class="token comment">// const modelInstance = await Admin.findByPk(id)</span>
  <span class="token comment">// if (!modelInstance) return</span>
  <span class="token comment">// modelInstance.loginId = await adminObj.loginId</span>
  <span class="token comment">// modelInstance.save()</span>
  <span class="token comment">// return modelInstance.toJSON()</span>
  Admin<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">loginId</span><span class="token operator">:</span> adminObj<span class="token punctuation">.</span>loginId <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  addAdmin<span class="token punctuation">,</span>
  deleteAdmin<span class="token punctuation">,</span>
  updateAdmin
<span class="token punctuation">}</span>
</code></pre></div><h2 id="æœåŠ¡ç«¯åˆ†å±‚æ¶æ„ğŸ«"><a href="#æœåŠ¡ç«¯åˆ†å±‚æ¶æ„ğŸ«" class="header-anchor">#</a> æœåŠ¡ç«¯åˆ†å±‚æ¶æ„ğŸ«</h2> <p><img src="/assets/img/1693967058339.c472ba87.png" alt="1693967058339"></p> <h3 id="routeå±‚"><a href="#routeå±‚" class="header-anchor">#</a> routeå±‚</h3> <p><strong>ä½œç”¨</strong> ï¼š è´Ÿè´£ å‰ç«¯è®¿é—®æœåŠ¡å™¨è·¯ç”±åœ°å€æ¥å£çš„å¤„ç†ï¼Œè½¬å‘åˆ°å¯¹åº”çš„<code>service</code> å±‚ï¼Œè´Ÿè´£æ¥å£åœ°å€é€»è¾‘å¤„ç†</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> studentRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./modules/students'</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/bff/student'</span> <span class="token punctuation">,</span> studentRouter<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listen in on 8081'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="serviceå±‚-2"><a href="#serviceå±‚-2" class="header-anchor">#</a> serviceå±‚</h3> <p><strong>ä½œç”¨</strong> ï¼š è´Ÿè´£å¤„ç†ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨æ­¤å±‚éªŒè¯æ•°æ®ç­‰æ“ä½œï¼Œé€šè¿‡åè°ƒç”¨ <code>model</code>å®ä¾‹çš„æ–¹æ³•è¿›è¡Œ <code>crud</code>æ“ä½œï¼Œè®©ç„¶åå°†å¯¹åº”çš„æ•°æ®è¿”å›</p> <p><strong>example</strong>ï¼ˆç¤ºä¾‹ï¼‰</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> Student <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../models/index'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> isEmpty <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils'</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStudents</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> pageSize <span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> where <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> pageSize <span class="token comment">// åˆ†é¡µé¡µæ•°  ç¬¬å‡ é¡µ </span>
  <span class="token keyword">const</span> limit <span class="token operator">=</span> pageSize <span class="token comment">// ä¸€é¡µå¤šå°‘æ¡</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> rows <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> Student<span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    where<span class="token punctuation">,</span>
    limit<span class="token punctuation">,</span>
    offset
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">total</span><span class="token operator">:</span> count<span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="modelå±‚"><a href="#modelå±‚" class="header-anchor">#</a> modelå±‚</h3> <p><strong>ä½œç”¨</strong>ï¼š è´Ÿè´£æ¨¡å‹æ•°æ®çš„å®šä¹‰ä»¥åŠç±»å‹å¤„ç†ï¼Œä½ å¯ä»¥é€šè¿‡æ¯ä¸ªå¯¹è±¡çš„ <code>set</code> or <code>get</code> è¿›è¡Œä¸­é—´å¤„ç†ï¼Œä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»ºè¯¥æ¨¡å‹æˆ–è€… æ‰¹é‡åˆ›å»ºæ¨¡å‹ï¼Œå½“ä½ è¿è¡Œ <code>sync</code>æ–¹æ³•æ—¶ å®ƒä¼šåŒæ­¥ä½ çš„æ¨¡å‹åˆ°æ•°æ®åº“ï¼Œå¹¶ä¸”ä½ è¿˜å¯ä»¥ä¸å…¶å®ƒè¡¨å»ºç«‹ å¤–é”® å…³ç³»ç­‰ã€‚</p> <p><strong>example</strong>ï¼ˆç¤ºä¾‹ï¼‰</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> DataTypes <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'sequelize'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> sequelize <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./db'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> modeNameGroup <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../constant'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Student <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>modeNameGroup<span class="token punctuation">.</span>Student<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// ç±»å‹</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataValue</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataValue</span><span class="token punctuation">(</span><span class="token string">'birthdady'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦å…è®¸ä¸ºç©º</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">birthdady</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// ç±»å‹</span>
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦å…è®¸ä¸ºç©º</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">updatedAt</span><span class="token operator">:</span> <span class="token string">'updateTime'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">deletedAt</span><span class="token operator">:</span> <span class="token string">&quot;deleteTime&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token string">&quot;createTime&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Student
</code></pre></div><h2 id="æ¨¡å‹æŸ¥è¯¢æ•°æ®-model-query-ğŸ›’"><a href="#æ¨¡å‹æŸ¥è¯¢æ•°æ®-model-query-ğŸ›’" class="header-anchor">#</a> æ¨¡å‹æŸ¥è¯¢æ•°æ®ï¼ˆmodel queryï¼‰ğŸ›’</h2> <h3 id="api"><a href="#api" class="header-anchor">#</a> API</h3> <p>1  : <code>findAll</code></p> <blockquote><p>æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> model<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
</code></pre></div><p>2 : <code>findByPk</code></p> <blockquote><p>æ ¹æ®æŒ‡å®šçš„å‚æ•°æŸ¥è¯¢ ï¼Œä¾‹å¦‚æ ¹æ® <code>id</code>æŸ¥è¯¢æ˜¯å¦æœ‰è¯¥è®°å½•ï¼Œæœ‰åˆ™è¿”å›å®ä¾‹ï¼Œå¦åˆ™è¿”å›null</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> model<span class="token punctuation">.</span><span class="token function">findByPk</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token comment">// æŸ¥è¯¢æ˜¯å¦æœ‰æ”¹æ¡è®°å½•</span>
</code></pre></div><p>3 ï¼š <code>findOne</code></p> <blockquote><p>æŸ¥æ‰¾ä¸€æ¡ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼Œè¿”å›ç»“æœ æœ‰åˆ™è¿”å›å®ä¾‹ï¼Œå¦åˆ™è¿”å›null</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> Admin<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      loginId<span class="token punctuation">,</span>
      loginPwd
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>4 ï¼š ``findOrCreate`</p> <blockquote><p>æŸ¥æ‰¾æˆ–è€…åˆ›å»ºä¸€æ¡è®°å½•ï¼Œå¦‚æœåœ¨dbä¸­æ‰¾åˆ°è¯¥æ•°æ®ï¼Œåˆ™è¿›è¡Œè¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿›è¡Œåˆ›å»ºï¼Œä½ å¯ä»¥ä¼ å…¥ <code>defaults</code>å±æ€§</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>user<span class="token punctuation">,</span> created<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'sdepold'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">defaults</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">job</span><span class="token operator">:</span> <span class="token string">'Technical Lead JavaScript'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>5 : <code>findAndCountAll</code></p> <blockquote><p>æŸ¥æ‰¾æ‰€æœ‰çš„æ•°æ®å¹¶ä¸”è¿”å›æŸ¥è¯¢æ‰€æœ‰æ•°æ®çš„æ¡æ•°</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> rows <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> Project<span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>like<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'foo%'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>6 ï¼š <code>bulkCreate</code></p> <blockquote><p>æ‰¹é‡åˆ›å»ºå¤šæ¡æ•°æ®åˆ°æ•°æ®åº“ä¸­ï¼Œä¼ å…¥ä¸€ä¸ªarray</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>stus<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span>
<span class="token keyword">const</span> studentIns <span class="token operator">=</span> <span class="token keyword">await</span> Student<span class="token punctuation">.</span><span class="token function">bulkCreate</span><span class="token punctuation">(</span>stus<span class="token punctuation">)</span> <span class="token comment">// æ‰¹é‡åˆ›å»ºæ•°æ®</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> studentIns<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>7 ï¼š <code>destory</code></p> <blockquote><p>æ¨¡å‹å®ä¾‹åˆ é™¤æ•°æ®æ“ä½œï¼Œä½ å¯ä»¥æ ¹æ®é…ç½®å†³å®šæ˜¯å¦çœŸæ­£åˆ é™¤æ•°æ®ã€‚</p></blockquote> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code> Admin<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ä½ å¯ä»¥é…ç½®æ¨¡å‹ä¸­çš„ å‚æ•° <code>Paranoid</code> å½“ ä¸º true æ—¶ä¸ä¼šçœŸæ­£åˆ é™¤æ•°æ®ï¼Œè€Œæ˜¯ä¿å­˜ä¸€ä¸ªåˆ é™¤çš„æ—¶é—´åˆ°æ•°æ®åº“ä¸­ã€‚</p> <h2 id="æ¨¡å‹åŸºç¡€ğŸ"><a href="#æ¨¡å‹åŸºç¡€ğŸ" class="header-anchor">#</a> æ¨¡å‹åŸºç¡€ğŸ</h2> <h3 id="æ¨¡å‹å®šä¹‰"><a href="#æ¨¡å‹å®šä¹‰" class="header-anchor">#</a> æ¨¡å‹å®šä¹‰</h3> <p>å®šä¹‰ä¸€ä¸ªè‡ªå·±çš„æ¨¡å‹ï¼Œä½¿ç”¨<code>defind</code>å®šä¹‰</p> <div class="language-js extra-class"><pre class="language-js"><code>sequelize<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>æ¨¡å‹åç§°ï¼Œæ¨¡å‹é€‰é¡¹ï¼‰
</code></pre></div><h3 id="æ¨¡å‹é…ç½®"><a href="#æ¨¡å‹é…ç½®" class="header-anchor">#</a> æ¨¡å‹é…ç½®</h3> <p><code>é‡è¦å‚æ•°</code></p> <p>1  ï¼š <code>paranoid</code></p> <p>å†³å®šæ˜¯å¦è¦çœŸæ­£çš„åˆ é™¤æ•°æ®è¡¨ä¸­çš„æ•°æ®</p> <p>2ï¼š<code>freezeTableName</code></p> <p>æ˜¯å¦è¦ä¸¥æ ¼æŒ‰ç…§æ¨¡å‹åç§°ä½œä¸ºè¡¨åã€‚</p> <p>3 ï¼š <code>getter</code>  or  <code>setter</code></p> <p>å½“ç”¨æˆ·è®¿é—®å±æ€§ æˆ–è€…è®¾ç½®å€¼å¾—æ—¶å€™ ä½œä¸€äº›ä¸­é—´æ“ä½œ</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// ç±»å‹</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataValue</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataValue</span><span class="token punctuation">(</span><span class="token string">'birthdady'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦å…è®¸ä¸ºç©º</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>4 ï¼š <code>validate</code></p> <p>æ¨¡å‹å±æ€§æ ¡éªŒï¼Œå¯ä»¥åœ¨å½“ä½ ç»™æ ¹æ®æ¨¡å‹åˆ›å»ºæ•°æ®çš„æ—¶å€™ï¼Œå¯ä»¥è¿›è¡Œæ ¡éªŒ</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// ç±»å‹</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataValue</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDataValue</span><span class="token punctuation">(</span><span class="token string">'birthdady'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">validate</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">notEmpty</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'å§“åä¸èƒ½æ•°ä¸ºç©º'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">notNull</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'å§“åä¸èƒ½æ•°ä¸ºç©º'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">allowNull</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦å…è®¸ä¸ºç©º</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="nodejs-æ—¥å¿—è¾“å‡ºâœŒ"><a href="#nodejs-æ—¥å¿—è¾“å‡ºâœŒ" class="header-anchor">#</a> nodejs-æ—¥å¿—è¾“å‡ºâœŒ</h2> <h3 id="log4jsğŸ–¥"><a href="#log4jsğŸ–¥" class="header-anchor">#</a> log4jsğŸ–¥</h3> <p><strong>ç»„æˆ</strong> ï¼š ä¸€ä¸ªæ—¥å¿—ç”± [æ—¶é—´] + [æ—¥å¿—ç­‰çº§] + [æ—¥å¿—åˆ†ç±»] + [æ—¥å¿—ä¿¡æ¯]  ç»„åˆè€Œæˆ</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> log4js <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'log4js'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> logger <span class="token operator">=</span> log4js<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token string">&quot;javascript&quot;</span><span class="token punctuation">)</span> <span class="token comment">// è®¾ç½®æ—¥å¿—ç±»å‹ ï¼Œ è¾“å‡ºåœ¨ [2023-09-11T10:04:20.666] [INFO] javascript - logger or in not a function ä¸­</span>

logger<span class="token punctuation">.</span>level <span class="token operator">=</span> log4js<span class="token punctuation">.</span>levels<span class="token punctuation">.</span><span class="token constant">ERROR</span>

logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;logger or in not a function&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="æ—¥å¿—é…ç½®"><a href="#æ—¥å¿—é…ç½®" class="header-anchor">#</a> æ—¥å¿—é…ç½®</h3> <p><a href="https://log4js-node.github.io/log4js-node/migration-guide.html" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> log4js <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'log4js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>

log4js<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment">// æ—¥å¿—é…ç½®</span>
  <span class="token literal-property property">appenders</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// æ·»åŠ ä¸€ä¸ªæ—¥å¿—æ˜ å°„ç±»å‹</span>
    <span class="token literal-property property">sqlLogAppender</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token comment">// è¾“å‡ºæ—¥å¿—ç±»å‹//</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./logs'</span><span class="token punctuation">,</span> <span class="token string">'sql'</span><span class="token punctuation">,</span> <span class="token string">'sql.log'</span><span class="token punctuation">)</span> <span class="token comment">//è¾“å‡ºæ—¥å¿—çš„åœ°å€</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">app</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'dateFile'</span><span class="token punctuation">,</span> <span class="token comment">//</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./logs'</span><span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">,</span> <span class="token string">'application.log'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pattern'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">'[%h] [%d{yyyy/MM/dd-hh.mm.ss}] %c - [%p] %m'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">maxLogSize</span><span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment">// æœ€å¤§æ–‡ä»¶å­˜å‚¨å¤§å°</span>
      <span class="token literal-property property">keepFileExt</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// æ˜¯å¦ä¿æŒæ–‡ä»¶ä»¥ .logç»“å°¾</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'file'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./logs'</span><span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">,</span> <span class="token string">'application.log'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">categories</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ—¥å¿— ç±»å‹ ï¼Œ å®ƒå¯ä»¥æ ¹æ® appenders ä¸ä¹‹å¯¹åº” ç„¶å è¾“å‡ºåˆ°ä¸åŒçš„æ—¥å¿—æ–‡ä»¶ä¸­</span>
    <span class="token literal-property property">sqlLog</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">appenders</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'sqlLogAppender'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// å¯¹åº”ä¸Šæ–¹appenders</span>
      <span class="token literal-property property">level</span><span class="token operator">:</span> <span class="token string">'all'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">app</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">appenders</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'app'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">level</span><span class="token operator">:</span> <span class="token string">'all'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">appenders</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">level</span><span class="token operator">:</span> <span class="token string">'all'</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'exit'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> log4js<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

exports<span class="token punctuation">.</span>sqlLog <span class="token operator">=</span> log4js<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token string">'sqlLog'</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span>appLog <span class="token operator">=</span> log4js<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span>logger <span class="token operator">=</span> log4js<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="æ—¥å¿—çº§åˆ«"><a href="#æ—¥å¿—çº§åˆ«" class="header-anchor">#</a> æ—¥å¿—çº§åˆ«</h3> <p><img src="/assets/img/1694397366818.39beb783.png" alt="1694397366818"></p> <h2 id="expressçš„åŸºæœ¬ä½¿ç”¨"><a href="#expressçš„åŸºæœ¬ä½¿ç”¨" class="header-anchor">#</a> expressçš„åŸºæœ¬ä½¿ç”¨</h2></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/web/sql/mysql.html" class="prev">
        Mysql
      </a></span> <span class="next"><a href="/web/express/express.html">
        express
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.feb21b2a.js" defer></script><script src="/assets/js/2.75ba61f2.js" defer></script><script src="/assets/js/6.695dc6e3.js" defer></script>
  </body>
</html>
